{% extends "layout.html" %}

{% block title %}–ó–∞–¥–∞–Ω–∏—è - Workers System{% endblock %}

{% block page_content %}
<div class="page-header">
    <div>
        <h1 class="page-title">–ó–∞–¥–∞–Ω–∏—è</h1>
        <p class="page-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏ –≤ —Å–∏—Å—Ç–µ–º–µ</p>
    </div>
</div>

<!-- Filters -->
<div class="filters">
    <a href="/orders" class="filter-button {% if not current_filter or current_filter == 'all' %}active{% endif %}">
        –í—Å–µ
    </a>
    <a href="/orders?status=pending" class="filter-button {% if current_filter == 'pending' %}active{% endif %}">
        –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
    </a>
    <a href="/orders?status=published" class="filter-button {% if current_filter == 'published' %}active{% endif %}">
        –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ
    </a>
    <a href="/orders?status=in_progress" class="filter-button {% if current_filter == 'in_progress' %}active{% endif %}">
        –í —Ä–∞–±–æ—Ç–µ
    </a>
    <a href="/orders?status=completed" class="filter-button {% if current_filter == 'completed' %}active{% endif %}">
        –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ
    </a>
</div>

<!-- Tasks List -->
{% if tasks %}
<div style="margin-bottom: 16px; color: #6b7280; font-size: 0.875rem;">
    –ù–∞–π–¥–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π: {{ tasks|length }}
</div>

{% for task in tasks %}
<div class="card">
    <div class="card-header">
        <h3 class="card-title">{{ task.title }}</h3>
        <span class="status-badge status-{{ task.status }}">
            {% set status_labels = {
                'draft': '–ß–µ—Ä–Ω–æ–≤–∏–∫',
                'pending': '–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏',
                'approved': '–û–¥–æ–±—Ä–µ–Ω–æ',
                'published': '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ',
                'in_progress': '–í —Ä–∞–±–æ—Ç–µ',
                'completed': '–í—ã–ø–æ–ª–Ω–µ–Ω–æ',
                'cancelled': '–û—Ç–º–µ–Ω–µ–Ω–æ',
                'urgent': '–°—Ä–æ—á–Ω–æ–µ'
            } %}
            {{ status_labels.get(task.status, task.status) }}
        </span>
    </div>

    <div class="grid grid-4" style="margin-bottom: 16px;">
        <div class="card-detail">
            <span>üìç</span>
            <span>{{ task.location }}</span>
        </div>
        <div class="card-detail">
            <span>üìÖ</span>
            <span>{{ task.start_datetime | format_datetime }}</span>
        </div>
        <div class="card-detail">
            <span>‚è∞</span>
            <span>{{ task.duration_hours }} —á–∞—Å–æ–≤</span>
        </div>
        <div class="card-detail">
            <span>üí∞</span>
            <span style="font-weight: 600;">{{ task.client_price | format_currency }}</span>
        </div>
    </div>

    {% if task.requirements %}
    <div style="margin-bottom: 16px;">
        <strong style="font-size: 0.875rem; color: #374151;">–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</strong>
        <div style="margin-top: 4px;">
            {% for req in task.requirements %}
            <span style="display: inline-block; margin: 2px 8px 2px 0; padding: 2px 8px; background-color: #f3f4f6; border-radius: 4px; font-size: 0.75rem; color: #374151;">
                {{ req.count }} 
                {% if req.worker_type == 'loader' %}–≥—Ä—É–∑—á–∏–∫{% elif req.worker_type == 'driver' %}–≤–æ–¥–∏—Ç–µ–ª—å{% elif req.worker_type == 'rigger' %}—Ç–∞–∫–µ–ª–∞–∂–Ω–∏–∫{% elif req.worker_type == 'cleaner' %}—É–±–æ—Ä—â–∏–∫{% else %}—Ä–∞–∑–Ω–æ—Ä–∞–±–æ—á–∏–π{% endif %}
            </span>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <div class="card-description">
        {{ task.description }}
    </div>

    <div style="margin-top: 16px; display: flex; gap: 8px; font-size: 0.75rem; color: #9ca3af;">
        <span>ID: {{ task.id }}</span>
        <span>‚Ä¢</span>
        <span>–°–æ–∑–¥–∞–Ω–æ: {{ task.created_at | format_date }}</span>
        <span>‚Ä¢</span>
        <span>–û—Ç–∫–ª–∏–∫–æ–≤: {{ task.applications_count }}</span>
    </div>
</div>
{% endfor %}

{% else %}
<div class="empty-state">
    <div class="empty-state-icon">üìã</div>
    <h3>–ó–∞–¥–∞–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
    <p>
        {% if current_filter and current_filter != 'all' %}
            –ù–µ—Ç –∑–∞–¥–∞–Ω–∏–π —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "{{ current_filter }}"
        {% else %}
            –í —Å–∏—Å—Ç–µ–º–µ –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞–Ω–∏–π
        {% endif %}
    </p>
</div>
{% endif %}
{% endblock %}